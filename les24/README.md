## PAM

### Ограничить доступ к системе для всех пользователей, кроме группы администраторов, в выходные дни (суббота и воскресенье), за исключением праздничных дней.

* Выберем метод PAM-аутентификации, так как у нас используется только ограничение по времени, то было бы логично использовать метод pam_time, однако, данный метод не работает с локальными группами пользователей, и, получается, что использование данного метода добавит нам большое количество однообразных строк с разными пользователями. В текущей ситуации лучше написать небольшой скрипт контроля и использовать модуль pam_exec


Создадим файл-скрипт /usr/local/bin/login.sh. В скрипте подписаны все условия. Скрипт работает по принципу: 
Если сегодня суббота или воскресенье, то нужно проверить, входит ли пользователь в группу admin, если не входит — то подключение запрещено. При любых других вариантах подключение разрешено. 
Укажем в файле /etc/pam.d/sshd модуль pam_exec и наш скрипт:

auth required pam_exec.so debug /usr/local/bin/login.sh

Для проверки создадим 2-х пользователей: otus и otusadm с паролем "Otus2022!". Пользователю otusadm добавим группу admin. 

Все эти действия сделаем при помощи ansible.

* Проверка работы:

Запуск тестового: vagrant up

В выходной день пробуем подключиться по ssh к ip 192.168.57.10 под пользователями: otus и otusadm. 
ssh otusadm@192.168.57.10
ssh otus@192.168.57.10

Для пользователя otus получаем ошибку

otus@192.168.57.10's password:   
Permission denied, please try again.  
